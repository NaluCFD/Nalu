/*------------------------------------------------------------------------*/
/*  Copyright 2014 Sandia Corporation.                                    */
/*  This software is released under the license detailed                  */
/*  in the file, LICENSE, which is located in the top-level Nalu          */
/*  directory structure                                                   */
/*------------------------------------------------------------------------*/


#include <PecletFunction.h>

// basic c++
#include <algorithm>
#include <cmath>

namespace sierra{
namespace nalu{

//==========================================================================
// Class Definition
//==========================================================================
// PecletFunction - base class
//==========================================================================
//--------------------------------------------------------------------------
//-------- constructor -----------------------------------------------------
//--------------------------------------------------------------------------
PecletFunction::PecletFunction()
{
  // nothing to do
}

//--------------------------------------------------------------------------
//-------- destructor ------------------------------------------------------
//--------------------------------------------------------------------------
PecletFunction::~PecletFunction()
{
  // nothing to do
}

//==========================================================================
// Class Definition
//==========================================================================
// ClassicPecletFunction - classic 
//==========================================================================
//--------------------------------------------------------------------------
//-------- constructor -----------------------------------------------------
//--------------------------------------------------------------------------
ClassicPecletFunction::ClassicPecletFunction( const double A, const double hf)
  : A_(A),
    hf_(hf)
{
  // nothing to do
}

//--------------------------------------------------------------------------
//-------- destructor ------------------------------------------------------
//--------------------------------------------------------------------------
ClassicPecletFunction::~ClassicPecletFunction()
{
  // nothing to do
}

//--------------------------------------------------------------------------
//-------- execute ---------------------------------------------------------
//--------------------------------------------------------------------------
double 
ClassicPecletFunction::execute(const double pecletNumber)
{
  const double modPeclet = hf_*pecletNumber;
  return modPeclet*modPeclet/(5.0 + modPeclet*modPeclet);
}

//==========================================================================
// Class Definition
//==========================================================================
// TanhFunction - classic 
//==========================================================================
//--------------------------------------------------------------------------
//-------- constructor -----------------------------------------------------
//--------------------------------------------------------------------------
TanhFunction::TanhFunction(double c1, double c2)
  : c1_(c1),
    c2_(c2)
{
  // nothing to do; assume that the functional form varies between 0 and 1
}

//--------------------------------------------------------------------------
//-------- destructor ------------------------------------------------------
//--------------------------------------------------------------------------
TanhFunction::~TanhFunction()
{
  // nothing to do
}

//--------------------------------------------------------------------------
//-------- execute ---------------------------------------------------------
//--------------------------------------------------------------------------
double 
TanhFunction::execute(const double indVar)
{
  return 0.50*(1.0+std::tanh((indVar-c1_)/c2_));
}

} // namespace nalu
} // namespace Sierra
